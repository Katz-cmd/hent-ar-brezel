<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hent Ar Brezel - French Tactical Apparel Landing Page</title>
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Hent Ar Brezel - French Tactical Apparel" />
    <meta property="og:description" content="Vêtements tactiques inspirés des unités d'élite françaises. Collection Neon Units - Qualité premium, design authentique." />
    <meta property="og:image" content="/655b4f8fbe94a9ab563f377b20e38a51_edited.jpg" />
    <meta property="og:url" content="https://hentarbrezel.com" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="Hent Ar Brezel" />
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Hent Ar Brezel - French Tactical Apparel" />
    <meta name="twitter:description" content="Vêtements tactiques inspirés des unités d'élite françaises. Collection Neon Units - Qualité premium, design authentique." />
    <meta name="twitter:image" content="/655b4f8fbe94a9ab563f377b20e38a51_edited.jpg" />

    <!-- Facebook Pixel Configuration -->
    <script>
        // Configuration - Edit these values as needed
        window.FB_CONFIG = {
            pixelId: '1452655989058364',
            capiEndpoint: 'https://capiworker.elhallaoui-mohamed1.workers.dev/',
            testEventCode: '', // Add test event code here when testing
            debug: true // Set to false in production
        };
    </script>

    <!-- Facebook Pixel Code - Simplified Version -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
        
        // Initialize pixel
        fbq('init', window.FB_CONFIG.pixelId);
        fbq('track', 'PageView');
        
        // Debug logging
        if (window.FB_CONFIG.debug) {
            console.log('Facebook Pixel initialized with ID:', window.FB_CONFIG.pixelId);
        }
    </script>
    <!-- End Facebook Pixel Code -->

    <!-- Enhanced Tracking with CAPI Support -->
    <script>
        // Simple cookie helper
        function getCookie(name) {
            const value = `; ${document.cookie}`;
            const parts = value.split(`; ${name}=`);
            if (parts.length === 2) return parts.pop().split(';').shift();
            return null;
        }

        // Generate unique event ID
        function generateEventId() {
            return Date.now().toString(36) + Math.random().toString(36).substring(2, 9);
        }

        // Enhanced fbq wrapper for CAPI support
        const originalFbq = window.fbq;
        window.fbq = function() {
            // Call original fbq
            originalFbq.apply(this, arguments);
            
            // If it's a track event, also send to CAPI
            if (arguments[0] === 'track' || arguments[0] === 'trackCustom') {
                sendToCAPI(arguments[0], arguments[1], arguments[2]);
            }
        };
        
        // Copy original fbq properties
        Object.keys(originalFbq).forEach(key => {
            window.fbq[key] = originalFbq[key];
        });

        // Send event to CAPI
        async function sendToCAPI(command, eventName, parameters = {}) {
            if (!window.FB_CONFIG.capiEndpoint) return;
            
            try {
                // Get Facebook cookies
                const fbc = getCookie('_fbc') || localStorage.getItem('_fbc');
                const fbp = getCookie('_fbp') || localStorage.getItem('_fbp');
                
                // Store cookies in localStorage for persistence
                if (fbc) localStorage.setItem('_fbc', fbc);
                if (fbp) localStorage.setItem('_fbp', fbp);
                
                // Get user data from localStorage
                const userData = {
                    fbc: fbc,
                    fbp: fbp,
                    em: localStorage.getItem('user_email_hash'), // Should be SHA256 hashed
                    ph: localStorage.getItem('user_phone_hash'), // Should be SHA256 hashed
                    external_id: localStorage.getItem('user_id') // Will be hashed by worker
                };
                
                // Build event payload
                const eventId = generateEventId();
                const payload = {
                    event_name: eventName,
                    event_time: Math.floor(Date.now() / 1000),
                    event_id: eventId,
                    action_source: 'website',
                    event_source_url: window.location.href,
                    user_data: userData,
                    custom_data: parameters
                };
                
                // Add test event code if configured
                if (window.FB_CONFIG.testEventCode) {
                    payload.test_event_code = window.FB_CONFIG.testEventCode;
                }
                
                // Send to CAPI worker
                const response = await fetch(window.FB_CONFIG.capiEndpoint, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(payload),
                    keepalive: true // Ensure request completes even if page unloads
                });
                
                if (window.FB_CONFIG.debug) {
                    const result = await response.json();
                    console.log('CAPI Response:', result);
                }
            } catch (error) {
                if (window.FB_CONFIG.debug) {
                    console.error('CAPI Error:', error);
                }
            }
        }

        // Track product page views
        document.addEventListener('DOMContentLoaded', function() {
            const productPages = {
                '/product/price_1RYQhID3hdzeARaV86yI6lOw': {
                    content_name: 'White Hoodie',
                    content_ids: ['BRZ-H002'],
                    content_type: 'product',
                    content_category: 'Hoodie',
                    value: 69.99,
                    currency: 'EUR'
                },
                '/product/price_1RYTLJD3hdzeARaVPyImkzCS': {
                    content_name: 'Blue Hoodie',
                    content_ids: ['BRZ-H003'],
                    content_type: 'product',
                    content_category: 'Hoodie',
                    value: 69.99,
                    currency: 'EUR'
                },
                '/product/price_1RYTMiD3hdzeARaVApuZgd0K': {
                    content_name: 'Red Hoodie',
                    content_ids: ['BRZ-H001'],
                    content_type: 'product',
                    content_category: 'Hoodie',
                    value: 69.99,
                    currency: 'EUR'
                },
                '/product/price_1RYTILD3hdzeARaVLdV8GKsK': {
                    content_name: 'Red T-Shirt',
                    content_ids: ['BRZ-T001'],
                    content_type: 'product',
                    content_category: 'T-Shirt',
                    value: 39.99,
                    currency: 'EUR'
                },
                '/product/price_1RYTFJD3hdzeARaV815G4LfJ': {
                    content_name: 'White T-Shirt',
                    content_ids: ['BRZ-T002'],
                    content_type: 'product',
                    content_category: 'T-Shirt',
                    value: 39.99,
                    currency: 'EUR'
                },
                '/product/price_1RYTFtD3hdzeARaVFK20gVjq': {
                    content_name: 'Blue T-Shirt',
                    content_ids: ['BRZ-T003'],
                    content_type: 'product',
                    content_category: 'T-Shirt',
                    value: 39.99,
                    currency: 'EUR'
                }
            };
            
            // Check if we're on a product page
            const currentPath = window.location.pathname;
            const productData = productPages[currentPath];
            
            if (productData) {
                // Track ViewContent event for product pages
                fbq('track', 'ViewContent', productData);
                
                if (window.FB_CONFIG.debug) {
                    console.log('Tracked ViewContent for:', productData.content_name);
                }
            }
        });

        // Helper function to track custom events
        window.trackCustomEvent = function(eventName, parameters = {}) {
            fbq('trackCustom', eventName, parameters);
            
            if (window.FB_CONFIG.debug) {
                console.log('Tracked custom event:', eventName, parameters);
            }
        };

        // Helper function to update user data
        window.updateUserData = function(email, phone, userId) {
            // This should be called after user provides their information
            // The actual hashing should be done server-side or using a secure method
            if (email) {
                // In production, hash the email before storing
                localStorage.setItem('user_email_hash', email); // Should be SHA256
            }
            if (phone) {
                // In production, hash the phone before storing
                localStorage.setItem('user_phone_hash', phone); // Should be SHA256
            }
            if (userId) {
                localStorage.setItem('user_id', userId);
            }
        };
    </script>

    <!-- Main App Scripts -->
    <script type="module" crossorigin src="/assets/index-dckquwlz.js"></script>
    <link rel="stylesheet" crossorigin href="/assets/index-ypvo4vrl.css">
</head>
<body>
    <div id="root"></div>
</body>
</html>